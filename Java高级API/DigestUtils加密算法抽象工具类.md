# DigestUtils加密算法抽象工具类

用户注册时（管理员添加新的账号信息时）的密码必须经过某种算法进行编码，并将得到的结果存储到数据库，而不允许将原始密码直接存储到数据库中！

原始密码通常可以称之为密码的**原文**，或称之为**明文**密码，经过编码处理的结果可称之为**密文**。

对明文密码进行编码处理时，**不可以**使用任何**加密算法**，因为**所有加密算法都是可以逆向运算的**，即：根据算法类型、加密参数、密文，可以通过运算得到密码原文！通常，加密算法只是用于保障数据在传输过程中的安全性！

#### 常见的消息算法有：

- MD（Message Digest）系列
  - MD2(128位，不推荐) / MD4(128位，不推荐) / MD5(128位)
- SHA（Secure Hash Algorithm）家族
  - SHA-1(160位，不推荐) / SHA-256(256位) / SHA-384(384位) / SHA-512(512位)

##### 在Spring Boot项目中，已有`DigestUtils`工具类，提供了使用MD5算法进行编码的API：

- `org.springframework.util.DigestUtils;`在Spring框架的util工具类包下

- ```java
  String md5DigestAsHex(byte[] bytes){}//该方法可将原文转换为密文
  ```

#### 测试类:

```java
package cn.tedu.csmall.product;

import org.junit.jupiter.api.Test;
import org.springframework.util.DigestUtils;

public class Md5Tests {

    @Test
    public void encode() {
        String rawPassword = "12345678";
        String encodedPassword = DigestUtils
                    .md5DigestAsHex(rawPassword.getBytes());
        System.out.println("原文：" + rawPassword);
        System.out.println("密文：" + encodedPassword);
    }
}
```

### 常见的加密算法分类:

常见的加密算法可以分成三类，对称加密算法，非对称加密算法和Hash算法。

#### 对称加密

指加密和解密使用相同密钥的加密算法。对称加密算法的优点在于加解密的高速度和使用长密钥时的难破解性。假设两个用户需要使用对称加密方法加密然后交换数据，则用户最少需要2个密钥并交换使用，如果企业内用户有n个，则整个企业共需要n×(n-1) 个密钥，密钥的生成和分发将成为企业信息部门的恶梦。对称加密算法的安全性取决于加密密钥的保存情况，但要求企业中每一个持有密钥的人都保守秘密是不可能的，他们通常会有意无意的把密钥泄漏出去——如果一个用户使用的密钥被入侵者所获得，入侵者便可以读取该用户密钥加密的所有文档，如果整个企业共用一个加密密钥，那整个企业文档的保密性便无从谈起。

常见的对称加密算法：DES、3DES、DESX、Blowfish、IDEA、RC4、RC5、RC6和AES

#### 非对称加密

指加密和解密使用不同密钥的加密算法，也称为公私钥加密。假设两个用户要加密交换数据，双方交换公钥，使用时一方用对方的公钥加密，另一方即可用自己的私钥解密。如果企业中有n个用户，企业需要生成n对密钥，并分发n个公钥。由于公钥是可以公开的，用户只要保管好自己的私钥即可，因此加密密钥的分发将变得十分简单。同时，由于每个用户的私钥是唯一的，其他用户除了可以可以通过信息发送者的公钥来验证信息的来源是否真实，还可以确保发送者无法否认曾发送过该信息。非对称加密的缺点是加解密速度要远远慢于对称加密，在某些极端情况下，甚至能比非对称加密慢上1000倍。

常见的非对称加密算法：RSA、ECC（移动设备用）、Diffie-Hellman、El Gamal、DSA（数字签名用）

#### Hash算法

Hash算法特别的地方在于它是一种单向算法，用户可以通过Hash算法对目标信息生成一段特定长度的唯一的Hash值，却不能通过这个Hash值重新获得目标信息。因此Hash算法常用在不可还原的密码存储、信息完整性校验等。

常见的Hash算法：MD2、MD4、MD5、HAVAL、SHA、SHA-1、HMAC、HMAC-MD5、HMAC-SHA1

加密算法的效能通常可以按照算法本身的复杂程度、密钥长度（密钥越长越安全）、加解密速度等来衡量。上述的算法中，除了DES密钥长度不够、MD2速度较慢已逐渐被淘汰外，其他算法仍在目前的加密系统产品中使用。